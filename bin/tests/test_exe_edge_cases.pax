module exe test_exe_edge_cases;

// Test parser and language edge cases not covered elsewhere

routine printf(const fmt: pointer to char; ...): int32; external 'msvcrt.dll';

(* 
   Multi-line block comment
   spanning several lines
*)

var
  a: int32;
  b: int32;
  result: int32;
  flag: boolean;

begin
  printf('=== Edge Cases Test ===\n\n');
  
  // Test 1: Empty statements
  printf('Test 1: Empty statements\n');
  ;
  ;;
  ;;;
  printf('  Empty statements parsed correctly\n');
  
  // Test 2: Block comments
  printf('\nTest 2: Block comments\n');
  (* single line block comment *)
  printf('  Block comment before statement works\n');
  (* inline *) a := 1; (* between *) b := 2; (* after *)
  printf('  Inline block comments work: a=%d, b=%d\n', a, b);
  
  // Test 3: Double unary operators
  printf('\nTest 3: Double unary operators\n');
  a := 5;
  result := -a;
  printf('  -5 = %d\n', result);
  result := --a;
  printf('  --5 = %d (double negative)\n', result);
  result := ---a;
  printf('  ---5 = %d (triple negative)\n', result);
  
  flag := true;
  if not flag then
    printf('  ERROR\n')
  else
    printf('  not true = false\n');
  end;
  
  if not not flag then
    printf('  not not true = true\n');
  end;
  
  // Test 4: Left-associativity of subtraction and division
  printf('\nTest 4: Left-associativity\n');
  result := 10 - 6 - 2;
  printf('  10 - 6 - 2 = %d (expect 2)\n', result);
  
  result := 24 / 4 / 2;
  printf('  24 / 4 / 2 = %d (expect 3)\n', result);
  
  result := 100 mod 30 mod 7;
  printf('  100 mod 30 mod 7 = %d (expect 3)\n', result);
  
  // Test 5: Deeply nested parentheses
  printf('\nTest 5: Deeply nested expressions\n');
  result := (((((1 + 2) * 3) - 4) + 5) * 2);
  printf('  (((((1+2)*3)-4)+5)*2) = %d (expect 20)\n', result);
  
  result := ((((((((1 + 1) + 1) + 1) + 1) + 1) + 1) + 1) + 1);
  printf('  8 nested additions of 1 = %d (expect 9)\n', result);
  
  printf('\n=== All Edge Case Tests Passed ===\n');
end.
