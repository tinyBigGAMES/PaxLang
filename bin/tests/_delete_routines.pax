module exe routines;

// Test routine declarations and calls

var
  result: int32;
  fact: int64;

// Simple procedure (no return value)
routine DoNothing();
begin
end;

// Function with return value
routine Add(const a: int32; const b: int32): int32;
begin
  return a + b;
end;

// Function with local variables
routine Sum(const n: int32): int32;
var
  i: int32;
  total: int32;
begin
  total := 0;
  for i := 1 to n do
    total := total + i;
  end;
  return total;
end;

// Recursive function - factorial
routine Factorial(const n: int64): int64;
begin
  if n <= 1 then
    return 1;
  else
    return n * Factorial(n - 1);
  end;
end;

// Recursive function - fibonacci
routine Fibonacci(const n: int32): int32;
begin
  if n <= 1 then
    return n;
  else
    return Fibonacci(n - 1) + Fibonacci(n - 2);
  end;
end;

// Var parameter (pass by reference)
routine Increment(var value: int32);
begin
  value := value + 1;
end;

// Swap using var parameters
routine Swap(var a: int32; var b: int32);
var
  temp: int32;
begin
  temp := a;
  a := b;
  b := temp;
end;

// Multiple parameters
routine Max3(const a: int32; const b: int32; const c: int32): int32;
var
  m: int32;
begin
  m := a;
  if b > m then
    m := b;
  end;
  if c > m then
    m := c;
  end;
  return m;
end;

begin
  // Call procedure
  DoNothing();
  
  // Call function
  result := Add(10, 20);  // 30
  
  // Call function with local vars
  result := Sum(10);  // 55
  
  // Recursive call
  fact := Factorial(10);  // 3628800
  
  // Fibonacci
  result := Fibonacci(10);  // 55
  
  // Var parameter
  result := 5;
  Increment(result);  // result = 6
  
  // Swap
  result := 10;
  fact := 20;
  // Swap requires both same type, skip for now
  
  // Multiple params
  result := Max3(10, 25, 15);  // 25
  
end.
